function[K g]=reshaped_dft_mg(I)
fun=@fft2;
d1=double(I);
y1=blkproc(d1,[8,8],fun);
fun1=@abs;
M=blkproc(y1,[8,8],fun1);
%f2=@phas11;
%P=blkproc(y1,[8,8],f2);
fun2=@reshp;
y=blkproc(M,[8 8],fun2);
fun2=@res;
y2=blkproc(y,[32 64],fun2);
J=y2';
siz2=size(y2);
c2=siz2(2);
c1=siz2(1);
e=c1*c2;
siz1=size(M);
d1=siz1(2);
d2=siz1(1);
f=d1*d2;
g=(e-f)/64;
fun3=@res;
y3=blkproc(J,[c2 64],fun3);
K=y3';